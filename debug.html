<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Axis Imaging - Debug Mode</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        margin: 0;
        padding: 20px;
        background: #f5f5f5;
      }
      .debug-panel {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .debug-panel h3 {
        margin-top: 0;
        color: #333;
      }
      .status {
        padding: 10px;
        border-radius: 4px;
        margin: 5px 0;
      }
      .status.success {
        background: #e8f5e8;
        border-left: 4px solid #4caf50;
      }
      .status.error {
        background: #ffebee;
        border-left: 4px solid #f44336;
      }
      .status.warning {
        background: #fff3e0;
        border-left: 4px solid #ff9800;
      }
      .component-container {
        border: 2px dashed #ddd;
        margin: 10px 0;
        min-height: 50px;
        position: relative;
      }
      .component-container::before {
        content: attr(data-component);
        position: absolute;
        top: -10px;
        left: 10px;
        background: white;
        padding: 2px 8px;
        font-size: 12px;
        color: #666;
      }
      #console-output {
        background: #1e1e1e;
        color: #fff;
        padding: 15px;
        border-radius: 4px;
        max-height: 300px;
        overflow-y: auto;
        font-family: "Courier New", monospace;
        font-size: 12px;
      }
    </style>
  </head>

  <body>
    <div class="debug-panel">
      <h3>üîß Axis Imaging - Component Loader Debug</h3>
      <div id="status">Initializing...</div>
    </div>

    <div class="debug-panel">
      <h3>üìã Console Output</h3>
      <div id="console-output">Starting diagnostics...</div>
    </div>

    <!-- Component Placeholders with Debug Info -->
    <div
      class="component-container"
      data-component="Header"
      id="header-component"
    ></div>
    <div
      class="component-container"
      data-component="Hero"
      id="hero-component"
    ></div>
    <div
      class="component-container"
      data-component="Features"
      id="features-component"
    ></div>
    <div
      class="component-container"
      data-component="Help"
      id="help-component"
    ></div>
    <div
      class="component-container"
      data-component="Diagnostic"
      id="diagnostic-component"
    ></div>
    <div
      class="component-container"
      data-component="Know"
      id="know-component"
    ></div>
    <div
      class="component-container"
      data-component="Booking"
      id="booking-component"
    ></div>
    <div
      class="component-container"
      data-component="FAQ"
      id="faq-component"
    ></div>
    <div
      class="component-container"
      data-component="CTA"
      id="cta-component"
    ></div>
    <div
      class="component-container"
      data-component="Footer"
      id="footer-component"
    ></div>

    <script type="module">
      // Capture console output
      const consoleOutput = document.getElementById("console-output");
      const statusDiv = document.getElementById("status");

      function addToConsole(message, type = "info") {
        const timestamp = new Date().toLocaleTimeString();
        const colors = {
          info: "#81c784",
          error: "#e57373",
          warning: "#ffb74d",
          success: "#4fc3f7",
        };

        consoleOutput.innerHTML += `<div style="color: ${
          colors[type] || "#fff"
        };">[${timestamp}] ${message}</div>`;
        consoleOutput.scrollTop = consoleOutput.scrollHeight;
      }

      // Override console methods to capture output
      const originalLog = console.log;
      const originalError = console.error;

      console.log = function (...args) {
        originalLog.apply(console, args);
        addToConsole(args.join(" "), "info");
      };

      console.error = function (...args) {
        originalError.apply(console, args);
        addToConsole(args.join(" "), "error");
      };

      async function runDiagnostics() {
        try {
          addToConsole("üîç Starting component loader diagnostics...", "info");
          statusDiv.innerHTML =
            '<div class="status warning">Running diagnostics...</div>';

          // Check if componentLoader exists
          addToConsole("üìÅ Checking componentLoader.js...", "info");

          let ComponentLoader;
          try {
            const module = await import("./assets/js/utils/componentLoader.js");
            ComponentLoader = module.default;
            addToConsole("‚úÖ ComponentLoader imported successfully", "success");
          } catch (error) {
            addToConsole(
              `‚ùå Failed to import ComponentLoader: ${error.message}`,
              "error"
            );
            statusDiv.innerHTML =
              '<div class="status error">ComponentLoader import failed</div>';
            return;
          }

          // Initialize loader
          const loader = new ComponentLoader();

          // Define components to test
          const components = [
            { path: "components/header.html", target: "#header-component" },
            { path: "components/hero.html", target: "#hero-component" },
            { path: "components/features.html", target: "#features-component" },
            { path: "components/help.html", target: "#help-component" },
            {
              path: "components/diagnostic.html",
              target: "#diagnostic-component",
            },
            { path: "components/know.html", target: "#know-component" },
            { path: "components/booking.html", target: "#booking-component" },
            { path: "components/faq.html", target: "#faq-component" },
            { path: "components/cta.html", target: "#cta-component" },
            { path: "components/footer.html", target: "#footer-component" },
          ];

          // Test component file existence
          addToConsole("üîç Testing component file paths...", "info");
          await loader.testComponentPaths(components);

          // Attempt to load components
          addToConsole("üì¶ Loading components...", "info");
          const results = await loader.loadComponents(components);

          // Show results
          const stats = loader.getStats();
          addToConsole(
            `üìä Results: ${stats.loaded} loaded, ${stats.errors} errors`,
            "info"
          );

          if (stats.errors === 0) {
            statusDiv.innerHTML =
              '<div class="status success">‚úÖ All components loaded successfully!</div>';

            // Try to load main.js
            try {
              addToConsole("üöÄ Loading main.js...", "info");
              await import("./assets/js/main.js");
              addToConsole("‚úÖ main.js loaded successfully", "success");
            } catch (error) {
              addToConsole(
                `‚ö†Ô∏è main.js not found or failed to load: ${error.message}`,
                "warning"
              );
            }
          } else {
            statusDiv.innerHTML = `<div class="status error">‚ùå ${stats.errors} components failed to load</div>`;
          }
        } catch (error) {
          addToConsole(`üí• Critical error: ${error.message}`, "error");
          statusDiv.innerHTML =
            '<div class="status error">Critical error occurred</div>';
        }
      }

      // Run diagnostics when DOM is ready
      document.addEventListener("DOMContentLoaded", runDiagnostics);
    </script>
  </body>
</html>
